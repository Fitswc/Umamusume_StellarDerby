#############
#Project:马娘FTL星球
#根据星海德比小说设定集改编
#文案：咕噜，小雨，数码
#Programmer：F
#Adaptor：F
#################
namespace = uma_preftl

##原始社会/封建社会/工业革命/FTL
##random 25possibilities pre ages

#生成
country_event = {
	id = uma_preftl.9999
	hide_window = yes

	is_triggered_only = yes
	trigger = {
		NOT = {
			has_country_flag = uma_has_create_pre_ftl_civilisation
		}
	}

	immediate = {
		set_country_flag = uma_has_create_pre_ftl_civilisation
		random_system = {
			limit = {
				distance = {
					source = root.solar_system
					min_jumps = 6
					max_jumps = 10
				}
				any_system_planet = {
					OR = {
						uma_has_normal_habitat_planet = yes
						uma_has_pd_habitat_planet = yes
					}
				}
			}

			random_system_planet = {
				limit = {
					OR = {
						uma_is_normal_habitat_planet = yes
						uma_is_pd_habitat_planet = yes
					}
				}
				uma_create_pre_ftl = yes
			}
		}
	}
}




##原始社会(Passive)
situation_event = {
	id = uma_preftl.1
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		owner = { #这里的owner是土著吗？
			NOT = {
				has_country_flag = uma_preftl_1_fired
			}
			is_regular_pre_ftl = yes
			OR = {
				pre_ftl_ancient_era = yes
			}
			capital_scope = {
				has_observation_outpost = yes
				observation_outpost = {
					has_mission = passive_observation
				}
				observation_outpost_owner = {
					is_ai = no
					is_species_class = umamusume
				}
			}
		}
	}

	immediate = {
		owner = {
			set_country_flag = uma_preftl_1_fired
			capital_scope = {
				save_event_target_as = uma_pre_ftl_planet
				observation_outpost_owner = {
					country_event = {
						id = uma_preftl.2
					}
				}
			}
		}
		set_situation_flag = has_ongoing_observation_event_chain
		# Setting this flag for the duration of the entire event chain
		# to prevent other observation events from interfering.
	}
}

#山洪爆发
country_event = {
	id = uma_preftl.2
	title = uma_preftl.2.title
	desc = uma_preftl.2.desc
	is_triggered_only = yes
	location = event_target:uma_pre_ftl_planet
	show_sound = event_default
	trackable = yes


	immediate = {
		event_target:uma_pre_ftl_planet.observation_outpost = {
			set_event_locked = yes
		}
	}

	option = {
		name = uma_preftl.2.a
		custom_tooltip = uma_preftl.2.a.tt
		enable_special_project = {
			name = UMA_PRE_FTL_FLOOD
			location = event_target:uma_pre_ftl_planet
			owner = root
		}

	}
	option = {
		name = uma_preftl.2.b
		custom_tooltip = uma_preftl.2.b.tt

	}

	after = {
		custom_tooltip = cannot_reveal_tt
		custom_tooltip = cannot_dismantle_outpost_tt
	}
}


country_event = {
	id = uma_preftl.3
	title = uma_preftl.3.title
	desc = uma_preftl.3.desc
	is_triggered_only = yes
	location = event_target:uma_pre_ftl_planet

	option = {
		name = uma_preftl.3.a #天哪
		event_target:uma_pre_ftl_planet = {
			go_to_next_pre_ftl_age = yes #原始社会->大竞走
		}
	}

}

























